{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Desktop\\\\Lilly021\\\\GIT\\\\Matchmaker\\\\matchmaker\\\\src\\\\pages\\\\user\\\\Registration.js\";\nimport React from \"react\";\nimport Page from \"../../common/Page\";\nimport { login, setTokenToLocalStorage, setUserToLocalStorage } from \"../../base/OAuth\";\nimport Validators from \"../../constants/ValidatorTypes\";\nimport { withRouter } from \"react-router-dom\";\nimport * as Actions from \"../../actions/Actions\";\nimport { connect } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\nimport RegistrationForm from \"../../components/forms/user/RegistrationForm\";\nimport { editUser, getUserRegistrationDetailsData, register, uploadProfileImage } from \"../../services/UserService\";\nimport { dateToString, stringToDate } from \"../../util/DateUtil\";\nimport strings from \"../../localization\";\n\nclass Registration extends Page {\n  constructor(props) {\n    super(props);\n    this.registerValidationList = {\n      email: [{\n        type: Validators.EMAIL\n      }],\n      password: [{\n        type: Validators.REQUIRED\n      }],\n      repeatPassword: [{\n        type: Validators.REQUIRED\n      }],\n      firstName: [{\n        type: Validators.REQUIRED\n      }],\n      lastName: [{\n        type: Validators.REQUIRED\n      }],\n      weight: [{\n        type: Validators.IS_NUMBER\n      }],\n      height: [{\n        type: Validators.IS_NUMBER\n      }],\n      position: [{\n        type: Validators.REQUIRED\n      }],\n      gender: [{\n        type: Validators.REQUIRED\n      }],\n      dateOfBirth: [{\n        type: Validators.REQUIRED\n      }],\n      countryId: [{\n        type: Validators.REQUIRED\n      }],\n      profileImage: [{\n        type: Validators.REQUIRED\n      }]\n    };\n    this.editValidationList = {\n      email: [{\n        type: Validators.EMAIL\n      }],\n      firstName: [{\n        type: Validators.REQUIRED\n      }],\n      lastName: [{\n        type: Validators.REQUIRED\n      }],\n      weight: [{\n        type: Validators.IS_NUMBER\n      }],\n      height: [{\n        type: Validators.IS_NUMBER\n      }],\n      position: [{\n        type: Validators.REQUIRED\n      }],\n      gender: [{\n        type: Validators.REQUIRED\n      }],\n      dateOfBirth: [{\n        type: Validators.REQUIRED\n      }],\n      countryId: [{\n        type: Validators.REQUIRED\n      }],\n      profileImage: [{\n        type: Validators.REQUIRED\n      }]\n    };\n\n    this.setEditorRef = editor => this.editor = editor;\n\n    this.state = {\n      data: {},\n      file: undefined,\n      profileImageZoom: 1,\n      errors: {},\n      redirectUrl: props.location.state ? props.location.state.redirectUrl : \"/\",\n      profileImageChanged: false,\n      refs: {\n        ytLinks: React.createRef(),\n        otherLinks: React.createRef()\n      }\n    };\n    this.submit = this.submit.bind(this);\n    this.validationList = this.props.edit ? this.editValidationList : this.registerValidationList;\n  }\n\n  componentDidMount() {\n    if (!this.props.edit) {\n      return;\n    }\n\n    this.props.showLoader();\n    getUserRegistrationDetailsData().then(response => {\n      this.props.hideLoader();\n\n      if (!response || !response.ok) {\n        return;\n      }\n\n      let dateOfBirth = stringToDate(response.data.user.dateOfBirth);\n      this.setState({\n        data: {\n          id: response.data.user.id,\n          firstName: response.data.user.firstName,\n          lastName: response.data.user.lastName,\n          gender: response.data.user.gender,\n          middleName: response.data.user.middleName,\n          email: response.data.user.email,\n          weight: response.data.user.playerInfo.weight,\n          height: response.data.user.playerInfo.height,\n          position: response.data.user.playerInfo.position,\n          euPassport: response.data.user.playerInfo.euPassport,\n          countryId: response.data.user.playerInfo.nationality.id,\n          placeOfBirth: response.data.user.playerInfo.placeOfBirth,\n          dateOfBirth: dateToString(response.data.user.dateOfBirth),\n          youtubeLink: this.transformLinks(response.data.youtubeLinks),\n          otherLinks: this.transformLinks(response.data.otherLinks),\n          day: dateOfBirth.day(),\n          month: dateOfBirth.month(),\n          year: dateOfBirth.year(),\n          profileImage: \"test\"\n        },\n        file: response.data.imageData\n      });\n    });\n  }\n\n  checkPassword() {\n    return this.state.data.password === this.state.data.repeatPassword;\n  }\n\n  submit() {\n    for (let [key, value] of Object.entries(this.state.refs)) {\n      value.current.add();\n    }\n\n    this.createLinksRequest();\n\n    if (!this.validate()) {\n      return;\n    }\n\n    if (!this.checkPassword()) {\n      this.setError(\"password\", strings.registrationForm.passwordNotMatch);\n      return;\n    }\n\n    this.props.showLoader();\n    let image = this.editor.getImage();\n    this.state.data.profileImage = image.toDataURL();\n    image.crossOrigin = \"Anonymous\";\n\n    if (this.props.edit) {\n      if (this.state.profileImageChanged) {\n        uploadProfileImage({\n          profileImage: image.toDataURL(\"image/jpeg\", 0.8)\n        }).then(response => {});\n      }\n\n      editUser(this.state.data).then(response => {\n        this.props.history.push(\"/edit-profile-details\");\n      });\n    } else {\n      register(this.state.data).then(response => {\n        if (!response || !response.ok) {\n          this.setError(\"email\", strings.registrationForm.emailExists);\n          this.props.hideLoader();\n          return;\n        }\n\n        setTokenToLocalStorage(response.data.token.access_token, response.data.token.refresh_token);\n        setUserToLocalStorage(response.data.user);\n        uploadProfileImage({\n          profileImage: image.toDataURL(\"image/jpeg\", 0.8)\n        }).then(response => {\n          this.props.history.push(\"/registration-details\");\n        });\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: \"register-page\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 9\n      }\n    }, strings.menu.Register), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-grid-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-grid-item\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(RegistrationForm, {\n      data: this.state.data,\n      errors: this.state.errors,\n      onFileChanged: this.onFileChanged,\n      file: this.state.file,\n      profileImageZoomChange: this.profileImageZoomChange,\n      profileImageZoom: this.state.profileImageZoom,\n      rotateImage: this.rotateImage,\n      setEditorRef: this.setEditorRef,\n      edit: this.props.edit,\n      onSubmit: this.submit,\n      onChange: this.changeData,\n      refs: this.state.refs,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"register-with-buttons\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 13\n      }\n    }, strings.registrationForm.continueWithDescription), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      href: \"#\",\n      className: \"fb btn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fab fa-facebook-f i\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 17\n      }\n    }), \" \", strings.loginForm.continueWith, \" Facebook\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      href: \"#\",\n      className: \"twitter btn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fab fa-twitter i\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 17\n      }\n    }), \" \", strings.loginForm.continueWith, \" Twitter\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      href: \"#\",\n      className: \"google btn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fab fa-google-plus-g i\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 17\n      }\n    }), \" \", strings.loginForm.continueWith, \" Google\")))));\n  }\n\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators({\n    showLoader: Actions.showLoader,\n    hideLoader: Actions.hideLoader\n  }, dispatch);\n}\n\nfunction mapStateToProps({\n  siteDataReducers,\n  authReducers\n}) {\n  return siteDataReducers;\n}\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Registration));","map":{"version":3,"sources":["C:/Users/User/Desktop/Lilly021/GIT/Matchmaker/matchmaker/src/pages/user/Registration.js"],"names":["React","Page","login","setTokenToLocalStorage","setUserToLocalStorage","Validators","withRouter","Actions","connect","bindActionCreators","RegistrationForm","editUser","getUserRegistrationDetailsData","register","uploadProfileImage","dateToString","stringToDate","strings","Registration","constructor","props","registerValidationList","email","type","EMAIL","password","REQUIRED","repeatPassword","firstName","lastName","weight","IS_NUMBER","height","position","gender","dateOfBirth","countryId","profileImage","editValidationList","setEditorRef","editor","state","data","file","undefined","profileImageZoom","errors","redirectUrl","location","profileImageChanged","refs","ytLinks","createRef","otherLinks","submit","bind","validationList","edit","componentDidMount","showLoader","then","response","hideLoader","ok","user","setState","id","middleName","playerInfo","euPassport","nationality","placeOfBirth","youtubeLink","transformLinks","youtubeLinks","day","month","year","imageData","checkPassword","key","value","Object","entries","current","add","createLinksRequest","validate","setError","registrationForm","passwordNotMatch","image","getImage","toDataURL","crossOrigin","history","push","emailExists","token","access_token","refresh_token","render","menu","Register","onFileChanged","profileImageZoomChange","rotateImage","changeData","continueWithDescription","loginForm","continueWith","mapDispatchToProps","dispatch","mapStateToProps","siteDataReducers","authReducers"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport Page from \"../../common/Page\";\r\nimport {\r\n  login,\r\n  setTokenToLocalStorage,\r\n  setUserToLocalStorage,\r\n} from \"../../base/OAuth\";\r\nimport Validators from \"../../constants/ValidatorTypes\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport * as Actions from \"../../actions/Actions\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport RegistrationForm from \"../../components/forms/user/RegistrationForm\";\r\nimport {\r\n  editUser,\r\n  getUserRegistrationDetailsData,\r\n  register,\r\n  uploadProfileImage,\r\n} from \"../../services/UserService\";\r\nimport { dateToString, stringToDate } from \"../../util/DateUtil\";\r\nimport strings from \"../../localization\";\r\n\r\nclass Registration extends Page {\r\n  registerValidationList = {\r\n    email: [{ type: Validators.EMAIL }],\r\n    password: [{ type: Validators.REQUIRED }],\r\n    repeatPassword: [{ type: Validators.REQUIRED }],\r\n    firstName: [{ type: Validators.REQUIRED }],\r\n    lastName: [{ type: Validators.REQUIRED }],\r\n    weight: [{ type: Validators.IS_NUMBER }],\r\n    height: [{ type: Validators.IS_NUMBER }],\r\n    position: [{ type: Validators.REQUIRED }],\r\n    gender: [{ type: Validators.REQUIRED }],\r\n    dateOfBirth: [{ type: Validators.REQUIRED }],\r\n    countryId: [{ type: Validators.REQUIRED }],\r\n    profileImage: [{ type: Validators.REQUIRED }],\r\n  };\r\n\r\n  editValidationList = {\r\n    email: [{ type: Validators.EMAIL }],\r\n    firstName: [{ type: Validators.REQUIRED }],\r\n    lastName: [{ type: Validators.REQUIRED }],\r\n    weight: [{ type: Validators.IS_NUMBER }],\r\n    height: [{ type: Validators.IS_NUMBER }],\r\n    position: [{ type: Validators.REQUIRED }],\r\n    gender: [{ type: Validators.REQUIRED }],\r\n    dateOfBirth: [{ type: Validators.REQUIRED }],\r\n    countryId: [{ type: Validators.REQUIRED }],\r\n    profileImage: [{ type: Validators.REQUIRED }],\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      data: {},\r\n      file: undefined,\r\n      profileImageZoom: 1,\r\n      errors: {},\r\n      redirectUrl: props.location.state\r\n        ? props.location.state.redirectUrl\r\n        : \"/\",\r\n      profileImageChanged: false,\r\n      refs: {\r\n        ytLinks: React.createRef(),\r\n        otherLinks: React.createRef(),\r\n      },\r\n    };\r\n    this.submit = this.submit.bind(this);\r\n\r\n    this.validationList = this.props.edit\r\n      ? this.editValidationList\r\n      : this.registerValidationList;\r\n  }\r\n\r\n  componentDidMount() {\r\n    if (!this.props.edit) {\r\n      return;\r\n    }\r\n\r\n    this.props.showLoader();\r\n\r\n    getUserRegistrationDetailsData().then((response) => {\r\n      this.props.hideLoader();\r\n\r\n      if (!response || !response.ok) {\r\n        return;\r\n      }\r\n\r\n      let dateOfBirth = stringToDate(response.data.user.dateOfBirth);\r\n\r\n      this.setState({\r\n        data: {\r\n          id: response.data.user.id,\r\n          firstName: response.data.user.firstName,\r\n          lastName: response.data.user.lastName,\r\n          gender: response.data.user.gender,\r\n          middleName: response.data.user.middleName,\r\n          email: response.data.user.email,\r\n          weight: response.data.user.playerInfo.weight,\r\n          height: response.data.user.playerInfo.height,\r\n          position: response.data.user.playerInfo.position,\r\n          euPassport: response.data.user.playerInfo.euPassport,\r\n          countryId: response.data.user.playerInfo.nationality.id,\r\n          placeOfBirth: response.data.user.playerInfo.placeOfBirth,\r\n          dateOfBirth: dateToString(response.data.user.dateOfBirth),\r\n          youtubeLink: this.transformLinks(response.data.youtubeLinks),\r\n          otherLinks: this.transformLinks(response.data.otherLinks),\r\n          day: dateOfBirth.day(),\r\n          month: dateOfBirth.month(),\r\n          year: dateOfBirth.year(),\r\n          profileImage: \"test\",\r\n        },\r\n        file: response.data.imageData,\r\n      });\r\n    });\r\n  }\r\n\r\n  setEditorRef = (editor) => (this.editor = editor);\r\n\r\n  checkPassword() {\r\n    return this.state.data.password === this.state.data.repeatPassword;\r\n  }\r\n\r\n  submit() {\r\n    for (let [key, value] of Object.entries(this.state.refs)) {\r\n      value.current.add();\r\n    }\r\n\r\n    this.createLinksRequest();\r\n\r\n    if (!this.validate()) {\r\n      return;\r\n    }\r\n\r\n    if (!this.checkPassword()) {\r\n      this.setError(\"password\", strings.registrationForm.passwordNotMatch);\r\n      return;\r\n    }\r\n\r\n    this.props.showLoader();\r\n\r\n    let image = this.editor.getImage();\r\n    this.state.data.profileImage = image.toDataURL();\r\n    image.crossOrigin = \"Anonymous\";\r\n\r\n    if (this.props.edit) {\r\n      if (this.state.profileImageChanged) {\r\n        uploadProfileImage({\r\n          profileImage: image.toDataURL(\"image/jpeg\", 0.8),\r\n        }).then((response) => {});\r\n      }\r\n\r\n      editUser(this.state.data).then((response) => {\r\n        this.props.history.push(\"/edit-profile-details\");\r\n      });\r\n    } else {\r\n      register(this.state.data).then((response) => {\r\n        if (!response || !response.ok) {\r\n          this.setError(\"email\", strings.registrationForm.emailExists);\r\n          this.props.hideLoader();\r\n          return;\r\n        }\r\n\r\n        setTokenToLocalStorage(\r\n          response.data.token.access_token,\r\n          response.data.token.refresh_token\r\n        );\r\n        setUserToLocalStorage(response.data.user);\r\n\r\n        uploadProfileImage({\r\n          profileImage: image.toDataURL(\"image/jpeg\", 0.8),\r\n        }).then((response) => {\r\n          this.props.history.push(\"/registration-details\");\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div id=\"register-page\">\r\n        <div className=\"title\">{strings.menu.Register}</div>\r\n\r\n        <div className=\"form-grid-container\">\r\n          <div className=\"form-grid-item\">\r\n            <RegistrationForm\r\n              data={this.state.data}\r\n              errors={this.state.errors}\r\n              onFileChanged={this.onFileChanged}\r\n              file={this.state.file}\r\n              profileImageZoomChange={this.profileImageZoomChange}\r\n              profileImageZoom={this.state.profileImageZoom}\r\n              rotateImage={this.rotateImage}\r\n              setEditorRef={this.setEditorRef}\r\n              edit={this.props.edit}\r\n              onSubmit={this.submit}\r\n              onChange={this.changeData}\r\n              refs={this.state.refs}\r\n            />\r\n          </div>\r\n\r\n          <div id=\"register-with-buttons\">\r\n            <div className=\"title\">\r\n              {strings.registrationForm.continueWithDescription}\r\n            </div>\r\n\r\n            <div className=\"row\">\r\n              <a href=\"#\" className=\"fb btn\">\r\n                <i className=\"fab fa-facebook-f i\"></i>{\" \"}\r\n                {strings.loginForm.continueWith} Facebook\r\n              </a>\r\n            </div>\r\n\r\n            <div className=\"row\">\r\n              <a href=\"#\" className=\"twitter btn\">\r\n                <i className=\"fab fa-twitter i\"></i>{\" \"}\r\n                {strings.loginForm.continueWith} Twitter\r\n              </a>\r\n            </div>\r\n            <div className=\"row\">\r\n              <a href=\"#\" className=\"google btn\">\r\n                <i className=\"fab fa-google-plus-g i\"></i>{\" \"}\r\n                {strings.loginForm.continueWith} Google\r\n              </a>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n  return bindActionCreators(\r\n    {\r\n      showLoader: Actions.showLoader,\r\n      hideLoader: Actions.hideLoader,\r\n    },\r\n    dispatch\r\n  );\r\n}\r\n\r\nfunction mapStateToProps({ siteDataReducers, authReducers }) {\r\n  return siteDataReducers;\r\n}\r\n\r\nexport default withRouter(\r\n  connect(mapStateToProps, mapDispatchToProps)(Registration)\r\n);\r\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _regeneratorRuntime from\"/home/korisnik/Desktop/Borkovac/MyProjects/Matchmaker/Matchmaker/matchmaker/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/korisnik/Desktop/Borkovac/MyProjects/Matchmaker/Matchmaker/matchmaker/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import CONFIG from\"../config\";import AuthenticationTypes from\"../constants/AuthenticationTypes\";import HttpMethod from\"../constants/HttpMethod\";import history from\"../history\";import{clearUserData}from\"./OAuth\";import axios from\"axios\";var Axios=function(){var instance;function createInstance(){return axios.create({baseURL:CONFIG.baseUrl});}return{getInstance:function getInstance(){if(!instance){instance=createInstance();}if(getTokenType()){instance.defaults.headers.common[\"Authorization\"]=getToken();}instance.all=axios.all;return instance;}};}();var refreshing=false;Axios.getInstance().interceptors.response.use(function(response){response.ok=response.status>=200&&response.status<300;//console.log(\"Response status here: \" + response.status);\nreturn response;},/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(error){var status;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:status=error.response.status;if(!(status===404)){_context.next=5;break;}history.push(\"/not-found\");_context.next=17;break;case 5:if(!(status===500)){_context.next=9;break;}history.push(\"/error\");_context.next=17;break;case 9:if(!(status===401)){_context.next=13;break;}history.push(\"/forbidden\");_context.next=17;break;case 13:if(!(status===403)){_context.next=17;break;}clearUserData();history.push(\"/\");return _context.abrupt(\"return\",error);case 17:return _context.abrupt(\"return\",error);case 18:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());export function request(_x2){return _request.apply(this,arguments);}function _request(){_request=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(url){var data,method,options,_args2=arguments;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:data=_args2.length>1&&_args2[1]!==undefined?_args2[1]:[];method=_args2.length>2&&_args2[2]!==undefined?_args2[2]:HttpMethod.GET;options=_args2.length>3&&_args2[3]!==undefined?_args2[3]:{};_context2.next=5;return connect(url,data,method,options);case 5:return _context2.abrupt(\"return\",_context2.sent);case 6:case\"end\":return _context2.stop();}}},_callee2);}));return _request.apply(this,arguments);}export function requestFile(_x3){return _requestFile.apply(this,arguments);}function _requestFile(){_requestFile=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(url){var data,method,tokenType,headers,_args3=arguments;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:data=_args3.length>1&&_args3[1]!==undefined?_args3[1]:[];method=_args3.length>2&&_args3[2]!==undefined?_args3[2]:HttpMethod.GET;_context3.prev=2;tokenType=getTokenType();headers={\"Access-Control-Allow-Credentials\":\"true\",\"Access-Control-Allow-Origin\":\"*\",\"Access-Control-Allow-Headers\":\"Authorization\",Accept:\"application/json\"};if(tokenType){headers[\"Authorization\"]=getToken();}_context3.next=8;return connect(CONFIG.baseUrl+url,headers,data,method,false);case 8:return _context3.abrupt(\"return\",_context3.sent);case 11:_context3.prev=11;_context3.t0=_context3[\"catch\"](2);history.push(\"/error\");case 14:case\"end\":return _context3.stop();}}},_callee3,null,[[2,11]]);}));return _requestFile.apply(this,arguments);}export function connect(_x4,_x5,_x6,_x7){return _connect.apply(this,arguments);}function _connect(){_connect=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(url,data,method,options){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.t0=method;_context4.next=_context4.t0===HttpMethod.GET?3:_context4.t0===HttpMethod.POST?6:_context4.t0===HttpMethod.PUT?7:_context4.t0===HttpMethod.DELETE?8:9;break;case 3:_context4.next=5;return Axios.getInstance().get(url+makeParametersList(data),options);case 5:return _context4.abrupt(\"return\",_context4.sent);case 6:return _context4.abrupt(\"return\",Axios.getInstance().post(url,data,options));case 7:return _context4.abrupt(\"return\",Axios.getInstance().put(url,data,options));case 8:return _context4.abrupt(\"return\",Axios.getInstance().delete(url,options));case 9:case\"end\":return _context4.stop();}}},_callee4);}));return _connect.apply(this,arguments);}export function makeParametersList(parameters){var parametersList=\"?\";Object.keys(parameters).map(function(key,index){return parametersList+=\"\".concat(key,\"=\").concat(parameters[key],\"&\");});parametersList=parametersList.slice(0,-1);return parametersList===\"?\"?\"\":parametersList;}export function getToken(){if(getTokenType()===AuthenticationTypes.BearerToken){return\"Bearer \"+localStorage.getItem(CONFIG.tokenKey);}else if(getTokenType()===AuthenticationTypes.SocialToken){return\"Social \"+localStorage.getItem(CONFIG.socialTokenKey);}return\"\";}export function getUserFromLocalStorage(){var user=localStorage.getItem(\"user\");return user?JSON.parse(user):null;}function getTokenType(){if(localStorage.getItem(CONFIG.tokenKey)){return AuthenticationTypes.BearerToken;}else if(localStorage.getItem(CONFIG.socialTokenKey)){return AuthenticationTypes.SocialToken;}return null;}","map":{"version":3,"sources":["/home/korisnik/Desktop/Borkovac/MyProjects/Matchmaker/Matchmaker/matchmaker/src/base/HTTP.js"],"names":["CONFIG","AuthenticationTypes","HttpMethod","history","clearUserData","axios","Axios","instance","createInstance","create","baseURL","baseUrl","getInstance","getTokenType","defaults","headers","common","getToken","all","refreshing","interceptors","response","use","ok","status","error","push","request","url","data","method","GET","options","connect","requestFile","tokenType","Accept","POST","PUT","DELETE","get","makeParametersList","post","put","delete","parameters","parametersList","Object","keys","map","key","index","slice","BearerToken","localStorage","getItem","tokenKey","SocialToken","socialTokenKey","getUserFromLocalStorage","user","JSON","parse"],"mappings":"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","sourcesContent":["import CONFIG from \"../config\";\nimport AuthenticationTypes from \"../constants/AuthenticationTypes\";\nimport HttpMethod from \"../constants/HttpMethod\";\nimport history from \"../history\";\nimport { clearUserData } from \"./OAuth\";\nimport axios from \"axios\";\n\nconst Axios = (function() {\n  let instance;\n\n  function createInstance() {\n    return axios.create({\n      baseURL: CONFIG.baseUrl\n    });\n  }\n\n  return {\n    getInstance: function() {\n      if (!instance) {\n        instance = createInstance();\n      }\n\n      if (getTokenType()) {\n        instance.defaults.headers.common[\"Authorization\"] = getToken();\n      }\n      instance.all = axios.all;\n\n      return instance;\n    }\n  };\n})();\n\nlet refreshing = false;\n\nAxios.getInstance().interceptors.response.use(\n  response => {\n    response.ok = response.status >= 200 && response.status < 300;\n    //console.log(\"Response status here: \" + response.status);\n\n    return response;\n  },\n  async error => {\n    const {\n      response: { status }\n    } = error;\n\n    if (status === 404) {\n      history.push(\"/not-found\");\n    } else if (status === 500) {\n      history.push(\"/error\");\n    } else if (status === 401) {\n      history.push(\"/forbidden\");\n    } else if (status === 403) {\n      clearUserData();\n      history.push(\"/\");\n      return error;\n    }\n\n    return error;\n  }\n);\n\nexport async function request(\n  url,\n  data = [],\n  method = HttpMethod.GET,\n  options = {}\n) {\n  return await connect(url, data, method, options);\n}\n\nexport async function requestFile(url, data = [], method = HttpMethod.GET) {\n  try {\n    let tokenType = getTokenType();\n\n    let headers = {\n      \"Access-Control-Allow-Credentials\": \"true\",\n      \"Access-Control-Allow-Origin\": \"*\",\n      \"Access-Control-Allow-Headers\": \"Authorization\",\n      Accept: \"application/json\"\n    };\n\n    if (tokenType) {\n      headers[\"Authorization\"] = getToken();\n    }\n\n    return await connect(CONFIG.baseUrl + url, headers, data, method, false);\n  } catch (error) {\n    history.push(\"/error\");\n  }\n}\n\nexport async function connect(url, data, method, options) {\n  switch (method) {\n    case HttpMethod.GET: {\n      return await Axios.getInstance().get(\n        url + makeParametersList(data),\n        options\n      );\n    }\n    case HttpMethod.POST:\n      return Axios.getInstance().post(url, data, options);\n    case HttpMethod.PUT:\n      return Axios.getInstance().put(url, data, options);\n    case HttpMethod.DELETE:\n      return Axios.getInstance().delete(url, options);\n  }\n}\n\nexport function makeParametersList(parameters) {\n  let parametersList = `?`;\n\n  Object.keys(parameters).map(\n    (key, index) => (parametersList += `${key}=${parameters[key]}&`)\n  );\n\n  parametersList = parametersList.slice(0, -1);\n\n  return parametersList === \"?\" ? \"\" : parametersList;\n}\n\nexport function getToken() {\n  if (getTokenType() === AuthenticationTypes.BearerToken) {\n    return \"Bearer \" + localStorage.getItem(CONFIG.tokenKey);\n  } else if (getTokenType() === AuthenticationTypes.SocialToken) {\n    return \"Social \" + localStorage.getItem(CONFIG.socialTokenKey);\n  }\n\n  return \"\";\n}\n\nexport function getUserFromLocalStorage() {\n  let user = localStorage.getItem(\"user\");\n  return user ? JSON.parse(user) : null;\n}\n\nfunction getTokenType() {\n  if (localStorage.getItem(CONFIG.tokenKey)) {\n    return AuthenticationTypes.BearerToken;\n  } else if (localStorage.getItem(CONFIG.socialTokenKey)) {\n    return AuthenticationTypes.SocialToken;\n  }\n\n  return null;\n}\n"]},"metadata":{},"sourceType":"module"}
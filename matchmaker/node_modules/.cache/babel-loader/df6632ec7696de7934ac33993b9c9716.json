{"ast":null,"code":"import _regeneratorRuntime from\"/home/korisnik/Desktop/Borkovac/MyProjects/Matchmaker/Matchmaker/matchmaker/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/korisnik/Desktop/Borkovac/MyProjects/Matchmaker/Matchmaker/matchmaker/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import CONFIG from\"../config\";import HttpMethod from\"../constants/HttpMethod\";import{request}from\"./HTTP\";import history from\"../history\";import{OK}from\"http-status-codes\";export function login(_x,_x2){return _login.apply(this,arguments);}function _login(){_login=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(username,password){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:clearUserData();// --- Never Used ---\n/*let data = {\n    client_id: CONFIG.clientId,\n    client_secret: CONFIG.clientSecret,\n    grant_type: \"password\",\n    username: username,\n    password: password\n  };*/response={status:OK,data:{user:{username:\"borkovac\",email:\"borkovac.dragan@gmail.com\"},access_token:\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.zS8VfSEv7h7nNVSkNhDIE783bVJTgPP9JlOHSDaIy1I\",refresh_token:\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.makKgC-n7pxiletqYhN77RKRvoS_9V7p9Y45dGjZrEY\"}};//return await request(\"/oauth/v2/token\", data, HttpMethod.GET, false).then(\n//response => {\n//if (!response.ok) {\n//  return response;\n//}\nsetTokenToLocalStorage(response.data.access_token,response.data.refresh_token);//return request(\"/user/current\").then(response => {\nif(response.data.user){setUserToLocalStorage(response.data.user);}return _context.abrupt(\"return\",response);case 5:case\"end\":return _context.stop();}}},_callee);}));return _login.apply(this,arguments);}export function socialLogin(_x3,_x4,_x5,_x6,_x7,_x8,_x9){return _socialLogin.apply(this,arguments);}function _socialLogin(){_socialLogin=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(provider,email,firstName,lastName,socialId,accessToken,expiresAt){var data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:data={provider:provider,email:email,firstName:firstName?firstName:\"\",lastName:lastName?lastName:\"\",socialId:socialId,accessToken:accessToken,expiresAt:expiresAt};_context2.next=3;return request(\"/social/authenticate\",data,HttpMethod.POST).then(function(response){if(!response.ok){return;}setSocialTokenToLocalStorage(response.data.access_token);return request(\"/user/current\").then(function(response){if(response.data.user){setUserToLocalStorage(response.data.user);}return response;});});case 3:return _context2.abrupt(\"return\",_context2.sent);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return _socialLogin.apply(this,arguments);}export function refreshToken(_x10){return _refreshToken.apply(this,arguments);}function _refreshToken(){_refreshToken=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(refreshToken){var data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:data={client_id:CONFIG.clientId,client_secret:CONFIG.clientSecret,grant_type:\"refresh_token\",refresh_token:refreshToken};_context3.next=3;return request(\"/oauth/v2/token\",data,HttpMethod.GET,false).then(function(data){setTokenToLocalStorage(data.access_token,data.refresh_token);return data.access_token!==undefined;});case 3:return _context3.abrupt(\"return\",_context3.sent);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return _refreshToken.apply(this,arguments);}export function logout(){clearUserData();history.push(\"/\");}export function setUserToLocalStorage(user){localStorage.setItem(\"user\",JSON.stringify(user));}export function getUserFromLocalStorage(){var user=localStorage.getItem(\"user\");return user?JSON.parse(user):null;}export function setTokenToLocalStorage(access_token,refresh_token){localStorage.setItem(CONFIG.tokenKey,access_token);localStorage.setItem(CONFIG.refreshTokenKey,refresh_token);}export function setSocialTokenToLocalStorage(access_token){localStorage.setItem(CONFIG.socialTokenKey,access_token);}export function clearUserData(){localStorage.removeItem(\"user\");localStorage.removeItem(CONFIG.tokenKey);localStorage.removeItem(CONFIG.refreshTokenKey);}export function getRefreshToken(){return localStorage.getItem(CONFIG.refreshTokenKey);}export function isUserLoggedIn(){return getUserFromLocalStorage()!=null;}","map":{"version":3,"sources":["/home/korisnik/Desktop/Borkovac/MyProjects/Matchmaker/Matchmaker/matchmaker/src/base/OAuth.js"],"names":["CONFIG","HttpMethod","request","history","OK","login","username","password","clearUserData","response","status","data","user","email","access_token","refresh_token","setTokenToLocalStorage","setUserToLocalStorage","socialLogin","provider","firstName","lastName","socialId","accessToken","expiresAt","POST","then","ok","setSocialTokenToLocalStorage","refreshToken","client_id","clientId","client_secret","clientSecret","grant_type","GET","undefined","logout","push","localStorage","setItem","JSON","stringify","getUserFromLocalStorage","getItem","parse","tokenKey","refreshTokenKey","socialTokenKey","removeItem","getRefreshToken","isUserLoggedIn"],"mappings":"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","sourcesContent":["import CONFIG from \"../config\";\nimport HttpMethod from \"../constants/HttpMethod\";\nimport { request } from \"./HTTP\";\nimport history from \"../history\";\nimport { OK } from \"http-status-codes\";\n\nexport async function login(username, password) {\n  clearUserData();\n\n  // --- Never Used ---\n  /*let data = {\n    client_id: CONFIG.clientId,\n    client_secret: CONFIG.clientSecret,\n    grant_type: \"password\",\n    username: username,\n    password: password\n  };*/\n\n  let response = {\n    status: OK,\n    data: {\n      user: {\n        username: \"borkovac\",\n        email: \"borkovac.dragan@gmail.com\"\n      },\n      access_token:\n        \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.zS8VfSEv7h7nNVSkNhDIE783bVJTgPP9JlOHSDaIy1I\",\n      refresh_token:\n        \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.makKgC-n7pxiletqYhN77RKRvoS_9V7p9Y45dGjZrEY\"\n    }\n  };\n\n  //return await request(\"/oauth/v2/token\", data, HttpMethod.GET, false).then(\n  //response => {\n  //if (!response.ok) {\n  //  return response;\n  //}\n\n  setTokenToLocalStorage(\n    response.data.access_token,\n    response.data.refresh_token\n  );\n\n  //return request(\"/user/current\").then(response => {\n  if (response.data.user) {\n    setUserToLocalStorage(response.data.user);\n  }\n\n  return response;\n  //});\n}\n\nexport async function socialLogin(\n  provider,\n  email,\n  firstName,\n  lastName,\n  socialId,\n  accessToken,\n  expiresAt\n) {\n  let data = {\n    provider: provider,\n    email: email,\n    firstName: firstName ? firstName : \"\",\n    lastName: lastName ? lastName : \"\",\n    socialId: socialId,\n    accessToken: accessToken,\n    expiresAt: expiresAt\n  };\n\n  return await request(\"/social/authenticate\", data, HttpMethod.POST).then(\n    response => {\n      if (!response.ok) {\n        return;\n      }\n\n      setSocialTokenToLocalStorage(response.data.access_token);\n\n      return request(\"/user/current\").then(response => {\n        if (response.data.user) {\n          setUserToLocalStorage(response.data.user);\n        }\n\n        return response;\n      });\n    }\n  );\n}\n\nexport async function refreshToken(refreshToken) {\n  let data = {\n    client_id: CONFIG.clientId,\n    client_secret: CONFIG.clientSecret,\n    grant_type: \"refresh_token\",\n    refresh_token: refreshToken\n  };\n\n  return await request(\"/oauth/v2/token\", data, HttpMethod.GET, false).then(\n    data => {\n      setTokenToLocalStorage(data.access_token, data.refresh_token);\n\n      return data.access_token !== undefined;\n    }\n  );\n}\n\nexport function logout() {\n  clearUserData();\n  history.push(\"/\");\n}\n\nexport function setUserToLocalStorage(user) {\n  localStorage.setItem(\"user\", JSON.stringify(user));\n}\n\nexport function getUserFromLocalStorage() {\n  let user = localStorage.getItem(\"user\");\n  return user ? JSON.parse(user) : null;\n}\n\nexport function setTokenToLocalStorage(access_token, refresh_token) {\n  localStorage.setItem(CONFIG.tokenKey, access_token);\n  localStorage.setItem(CONFIG.refreshTokenKey, refresh_token);\n}\n\nexport function setSocialTokenToLocalStorage(access_token) {\n  localStorage.setItem(CONFIG.socialTokenKey, access_token);\n}\n\nexport function clearUserData() {\n  localStorage.removeItem(\"user\");\n  localStorage.removeItem(CONFIG.tokenKey);\n  localStorage.removeItem(CONFIG.refreshTokenKey);\n}\n\nexport function getRefreshToken() {\n  return localStorage.getItem(CONFIG.refreshTokenKey);\n}\n\nexport function isUserLoggedIn() {\n  return getUserFromLocalStorage() != null;\n}\n"]},"metadata":{},"sourceType":"module"}